---
layout:     post
published:  true
title:      "Linux常用工具和命令"
subtitle:   "Linux笔记"
date:       2021-7-12 14:00:00
author:     "Manual"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - Linux
---

> 本文介绍了Linux常用工具和命令，长期更新

### 文件操作命令

- ls
  - `ls -lrt` 递归显示文件的详细信息并按照时间排序。
- head
  - `head -n 100 filename`，显示文件的前几行内容。
- tail
  - `tail -n 100 filename` 显示文件尾，指定显示行数，默认10行。
  - `tail -f filename` 可以对某个文件进行动态监控。
- chmod
  - `chmod 777 filename` 修改文件的权限为用户，用户组，其他人有所有权限，权限组合是 1 2 4，分别代表x w r。
- rm
  - `rm -r` 递归删除子目录。
  - `rm -f` 强制删除。
- vim的三种模式
  - 命令模式（一般模式）。
  - 编辑模式，通过i或者a。
  - 末行模式，按Esc冒号进入，wq代表保存写入内容并退出，q!代表强制退出不保存。
  - 查找，命令模式输入 `/` 然后键入需要查找的字符串，按回车后就会进行查找，`?` 与`/` 功能相同，只不过 `?` 是向上而 `/` 是向下查找，进入查找之后，输入`n`表示继续查找，`N`表示反向查找。
  - 替换，`:{作用范围}s/{目标}/{替换}/{替换标志}`，例如`:%s/foo/bar/g`会在全局范围（`%`）查找`foo`并替换为`bar`，所有出现都会被替换（`g`），`:s/foo/bar/g`表示作用范围是当前行，`:s/foo/bar`空替换标志表示替换从光标位置开始第一次出现。
- touch
  - `touch filename` 创建文件。
- nl
  - `nl filename`和`cat -n`一样，从第一行输出全部内容，并且把行号显示出来。
- cat
  - cat的功能是将文件从第一行开始连续的将内容输出在屏幕上，当文件大，行数比较多时，屏幕无法全部容下时，只能看到一部分内容，所以通常使用重定向的方式，输出满足指定格式的内容。
  - `cat -n filename` （-n ： 显示时，连行号一起输出）。
- tac
  - tac的功能是将文件从最后一行开始倒过来将内容数据输出到屏幕上。
  - `tac filename`
- more
  - more的功能是将文件从第一行开始，根据输出窗口的大小，适当的输出文件内容。
  - `more filename`
  - Enter 向下n行，需要定义，默认为1行； 
  - Ctrl f 向下滚动一屏； 
  - 空格键 向下滚动一屏； 
  - Ctrl b 返回上一屏； 
  - = 输出当前行的行号； 
  - :f 输出文件名和当前行的行号； 
  - v 调用vi编辑器； 
  - ! 命令 调用Shell，并执行命令； 
  - q 退出more；
  - 配合管道符“\|”使用，例如:ls -al \| more。
- less的功能和more相似。
  - 可以使用【pageup】和【pagedown】键进行前翻页和后翻页。
  - `less filename`
- cp
  - `cp a b` 将文件进行复制，复制完成后会有两个文件 a 和 b。
- mv
  - `mv a b` 相当于是文件的移动，移动完成后就不再有 a 文件，或者用来对文件或目录重新命名。
- find
  - `find /home -name "*.txt"` 在`/home`目录下查找以.txt 结尾的文件名。

### 压缩文件操作命令

- 打包并压缩文件：

  Linux 中的打包文件一般是以.tar结尾的，压缩的命令一般是以.gz结尾的，而一般情况下打包和压缩是一起进行的，打包并压缩后的文件的后缀名一般.tar.gz。

  `tar -zcvf 打包压缩后的文件名 要打包压缩的文件` ，其中：

  - z：调用 gzip 压缩命令进行压缩。
  - c：打包文件。
  - v：显示运行过程。
  - f：指定文件名。

  示例：假如 test 目录下有三个文件分别是：aaa.txt bbb.txt ccc.txt，如果我们要打包 test 目录并指定压缩后的压缩包名称为 test.tar.gz 可以使用命令：`tar -zcvf test.tar.gz aaa.txt bbb.txt ccc.txt` 或 `tar -zcvf test.tar.gz /test/`。

- 解压压缩包：

  `tar [-xvf] 压缩文件`，其中：

  - x：代表解压。

  示例：将 /test 下的 test.tar.gz 解压到当前目录下可以使用命令：`tar -xvf test.tar.gz`，将 /test 下的 test.tar.gz 解压到根目录/usr 下：`tar -xvf test.tar.gz -C /usr`（- C 代表指定解压的位置）。

### 磁盘及内存命令

- 文件大小和占用空间大小是不一样的，因为要对齐。
- 显示每个文件和目录的磁盘使用空间。
  - (disk used) du -h
- 显示磁盘分区上可以使用的磁盘空间。
  - (disk free) df -h
- 显示内存使用情况。
  - free
    - 如果加上 -h 选项，输出的结果会友好很多。
    - 有时需要持续的观察内存的状况，此时可以使用 -s 选项并指定间隔的秒数：`$ free -h -s 3`，每隔 3 秒输出一次内存的使用情况，直到按下ctrl + c。
  - Mem是物理内存的使用情况。
  - Swap是交换空间的使用情况。
  - total是物理内存和交换空间的总大小。
  - used是物理内存和交换空间已经被使用的大小。
  - free是物理内存和交换空间可用空间（从内核和系统的角度看，真正尚未被使用的物理内存数量）。
  - shared 列显示被共享使用的物理内存大小。
  - buff/cache 列显示被 buffer 和 cache 使用的物理内存大小（其实是内存为缓存磁盘数据设置的缓冲区）。
  - available 列显示还可以被应用程序使用的物理内存大小，当应用程序需要内存时，如果没有足够的 free 内存可以用，内核就会从 buffer 和 cache 中回收内存来满足应用程序的请求，理想来说available = free + buffer + cache。

### 进程命令

- ps
  - 当前运行的进程的快照，指定ps命令的那个时刻的那些进程。
  - `ps aux` 查看所有的在内存中的进程信息，`a`代表all，`u`代表user，`x`经常与a一起使用。
  - `ps -ajx` 查看进程组相关信息，可以追踪进程之间的血缘关系。
  - `ps -ef` 显示所有进程信息，并显示程序间的关系。
  - `ps -u username` 显示指定用户username信息。
- top
  - 实时显示系统中各个进程的资源占用情况，在窗口输入k之后输入PID，会提示输入停止进程模式，有SIGTERM和SIGKILL，如果留空不输入，就是SIGTERM（优雅停止），按"q"退出top命令。
  - `top -H -p pid` 显示对应pid的所有线程资源使用情况。
  - `load average` 表示系统最近1min，5min，15min的平均负载，越大表示负载越来越小。
  - %MEM物理内存占用比。
  - Cpu(s)和%CPU
    - Cpu(s)表示的是所有用户进程占用整个cpu的平均值。
    - %CPU显示的是进程占用一个核的百分比，而不是整个cpu（8核）的百分比，有时候可能大于100，那是因为该进程启用了多线程占用了多个核心，所以有时候我们看该值得时候会超过100%，但不会超过总核数*100。
- kill
  - 杀掉进程。
  - `kill -l` 查看信号相关的信息，给进程发送一个信号。
  - `kill -9 pid` 杀掉指定进程，SIGKILL，9号信号。
- lsof
  - 列出当前系统打开文件的工具。
  - `lsof -i:8600` 查看8600端口的运行情况。
  - `lsof -u username` 查看username打开的文件。
  - `lsof -c string` 查看包含指定字符的进程所打开的文件。
- jobs
  - 查看当前控制台的后台进程。
  - 想要停止后台进程，使用jobs命令查看其进程号（比如为num），然后kill %num即可。

### 网络命令

- netstat
  - 用于显示与IP、TCP、UDP、和ICMP协议相关的统计数据，用于检验本机各端口的网络连接情况。
  - `-a` 列出所有端口。
  - `-p` 显示出进程和PID。
  - `-n` 将主机、端口和用户名用数字代替。
  - `netstat -apn | grep port` 显示指定端口的状态信息和进程信息。
- tcpdump
  - tcpdump可以将网络中传送的数据包的“头”完全截获下来提供分析，是一款网络分析工具。
  - `tcpdump host ip` 截获主机发出和收到的数据包。
  - `tcpdump port 6666` 截获端口上通过的包。
  - `tcpdump -i eth0` 截获某网卡上的包。
  - `sudo tcpdump -i any port 端口 -w 文件名.cap` 将某端口收发的数据包保存到文件。
  - `sudo tcpdump -i any port 端口 -Xnlps0` 打印请求到屏幕。
  - `tcpdump` 默认启动，普通情况下，直接启动tcpdump将监视第一个网络接口上所有流过的数据包。
- ping
  - `ping ip` 用于测试另一台主机是否可达，测试网络是否连通以及时延。
  - windows下ping是32比特，默认发送4次数据包结束。
  - linux下ping是64比特，默认不停发送数据包，直到手动停止。
- host
  - `host 域名` 返回域名的IP地址。
  - 用来查询DNS记录。
- ifconfig
  - 输出当前系统中所有处于活动状态的网络接口。
  - `ifconfig eth0 ip/24` 手工指定网卡的IP地址和广播地址，其中广播地址可以根据掩码计算出来。
  - `ifconfig eth0 up` 启动网卡eth0。
  - `ifconfig eth0 down` 关闭网卡eth0。
- traceroute
  - traceroute用来**跟踪一个分组从源点到终点的路径，及到达其中每一个路由器的往返时间**。
- crontab
  - 用来指定用户计划任务，用户将需要定时执行的任务写入crontab文件中，提交给crond进程定期执行，crontab命令用来对crontab文件进行管理。
  - `crontab [-u user] file` -u user，用来设定某个用户的crontab服务，例如，“-u ixdba”表示设定ixdba用户的crontab服务，此参数一般有root用户来运行。file，file是命令文件的名字，表示将file做为crontab的任务列表文件并载入crontab，如果在命令行中没有指定这个文件，crontab命令将接受标准输入（键盘）上键入的命令，并将它们载入crontab。
  - `crontab [-u user] [ -e | -l | -r ]` -e，编辑某个用户的crontab文件内容，如果不指定用户，则表示编辑当前用户的crontab文件。-l，显示某个用户的crontab文件内容，如果不指定用户，则表示显示当前用户的crontab文件内容。-r，从/var/spool/cron目录中删除某个用户的crontab文件，如果不指定用户，则默认删除当前用户的crontab文件。-i，在删除用户的crontab文件时给确认提示。
  - crontab命令可以在固定的间隔时间执行指定的系统指令或shell script脚本，时间间隔的单位可以是分钟、小时、日、月、周及以上的任意组合，非常设合周期性的日志分析或数据备份等工作。
- crond是Linux下的周期性执行系统任务的守护进程，他会根据/etc下的crontab配置文件的内容执行，用户需要将计划任务写入crontab文件中才能执行。用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：

  - minute   hour   day   month   week   command
  - minute： 表示分钟，可以是从0到59之间的任何整数。
  - hour：表示小时，可以是从0到23之间的任何整数。
  - day：表示日期，可以是从1到31之间的任何整数。
  - month：表示月份，可以是从1到12之间的任何整数。
  - week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。
  - command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。
  - 星号（*）：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。
  - 逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”
  - 中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”
  - 正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次，同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。

### 文本处理工具

- sed
  - sed主要以行为单位进行处理，可以将数据行进行替换、删除、新增、选取等操作。
- awk
  - awk是一种语言，它适合文本处理和报表生成。

### 字符处理命令

- 管道|
  - 管道|可以把一个命令的标准输出传送到另一个命令的标准输入中，连续的|意味着第一个命令的输出为第二个命令的输入，第二个命令的输入为第一个命令的输出，依次类推。
- grep
  - grep是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。
- 通配符
  - `*` 可以匹配一个或者多个可能的字符串。
    - `ls *.c` 列举出所有文件名以 `.c` 结束的文件。
  - `?` 负责匹配任意一个字符。
  - `[]` 在中括号中的字符可以表示其中任意一个。
    - `ls [abc]*` 列举出所有以 `a`、`b` 或者 `c` 开头的文件。