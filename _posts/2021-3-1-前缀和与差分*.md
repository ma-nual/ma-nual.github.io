---
layout:     post
published:  true
title:      "前缀和与差分"
subtitle:   "算法笔记"
date:       2021-3-1 9:00:00
author:     "Manual"
header-img: "img/post-bg-2015.jpg"
catalog: true
tags:
    - 算法
---

> 本文介绍了前缀和与差分的相关知识

## 算法思想

**一维前缀和：**

有一维数组a，前缀和s，`s[i] = s[i - 1] + a[i]`，`s[0] = 0`处理边界计算下标从1开始，前缀和可以快速计算出数组中的一段和，`s[l,r] = s[r] - s[l - 1]`

**二维前缀和：**

有二维数组a，前缀和s，`s[x][y]`是以(x,y)为右下角的矩阵的和，`s[i][j] = s[i - 1][j] + s[i][j - 1] - s[i - 1][j - 1] + a[i][j]` ，`s[0][0] = 0`处理边界计算下标从(1,1)开始，前缀和可以快速计算出数组中的子矩阵和，`{[x1,y1],[x2,y2]} = s[x2][y2] - s[x2][y1 - 1] - s[x1 - 1][y2] + s[x1 - 1][y1 - 1]`

**一维差分：**

有一维数组a，差分数组b，数组a就是数组b的前缀和，`b[i] = a[i] - a[i - 1]`，`b[0] = 0`处理边界计算下标从1开始，构造差分数组也可以使用插入加数值的方式将`a[i]`插入，差分可以快速的将数组中的一段子数组加c，先计算`b[l] = b[l] + c`，`b[r + 1] = b[r + 1] - c`，求b的前缀和`b[i] = b[i] + b[i - 1]`得到计算后的数组a

**二维差分：**

有二维数组a，差分数组b，`b[x][y]`是以(x,y)为右下角的矩阵的差分，`b[0][0] = 0`处理边界计算下标从(1,1)开始，构造差分数组也可以使用插入加数值的方式将`a[i][j]`插入，差分可以快速的将子矩阵加c，先计算`b[x1][y1] += c`，`b[x2 + 1][y1] -= c`，`b[x1][y2 + 1] -= c`，`b[x2 + 1][y2 + 1] += c`，求b的前缀和`b[i][j] = b[i][j] + b[i - 1][j] + b[i][j - 1] - b[i - 1][j - 1]`

## 算法模板

**一维前缀和**

```c++
S[i] = a[1] + a[2] + ... a[i]
a[l] + ... + a[r] = S[r] - S[l - 1]
```

**二维前缀和**

```c++
S[i, j] = 第i行j列格子左上部分所有元素的和
以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵的和为：
S[x2, y2] - S[x1 - 1, y2] - S[x2, y1 - 1] + S[x1 - 1, y1 - 1]
```

**一维差分**

```c++
给区间[l, r]中的每个数加上c：B[l] += c, B[r + 1] -= c
```

**二维差分**

```c++
给以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵中的所有元素加上c：
S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c
```

## 相关题目（补充）

